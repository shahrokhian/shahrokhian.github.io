function init(){var e=new THREERoot({createCameraControls:!1,antialias:1===window.devicePixelRatio,fov:60});e.renderer.setClearColor(0),e.renderer.setPixelRatio(window.devicePixelRatio||1),e.camera.position.set(0,0,600);var t=createTextAnimation();e.scene.add(t);var n=new THREE.DirectionalLight;n.position.set(0,0,1),e.scene.add(n);var i=new TimelineMax({repeat:-1,repeatDelay:.5,yoyo:!0});i.fromTo(t,4,{animationProgress:0},{animationProgress:.6,ease:Power1.easeInOut},0),i.fromTo(t.rotation,4,{y:0},{y:2*Math.PI,ease:Power1.easeInOut},0),createTweenScrubber(i)}function createTextAnimation(){var e=generateTextGeometry("Reza Shahrokhian",{size:40,height:12,font:"droid sans",weight:"bold",style:"normal",curveSegments:24,bevelSize:2,bevelThickness:2,bevelEnabled:!0,anchor:{x:.5,y:.5,z:0}});return THREE.BAS.Utils.tessellateRepeat(e,1,2),THREE.BAS.Utils.separateFaces(e),new TextAnimation(e)}function generateTextGeometry(e,t){var n=new THREE.TextGeometry(e,t);n.computeBoundingBox();var i=n.boundingBox.size(),r=i.x*-t.anchor.x,a=i.y*-t.anchor.y,o=i.z*-t.anchor.z,s=(new THREE.Matrix4).makeTranslation(r,a,o);return n.applyMatrix(s),n}function TextAnimation(e){var t,n,i,r,a,o=new THREE.BAS.ModelBufferGeometry(e),s=o.createAttribute("aAnimation",2),c=o.createAttribute("aEndPosition",3),u=o.createAttribute("aAxisAngle",4),d=o.faceCount,h=0,l=1,m=1,f=.05,E=.001,w=e.boundingBox.max.length();this.animationDuration=m+h+f+E*w,this._animationProgress=0;var T,y=new THREE.Vector3;for(t=0,n=0,i=0,r=0;t<d;t++,n+=6,i+=9,r+=12){var v=e.faces[t],x=THREE.BAS.Utils.computeCentroid(e,v),p=(new THREE.Vector3).copy(x).normalize(),g=(w-x.length())*E,R=THREE.Math.randFloat(l,m);for(a=0;a<6;a+=2)s.array[n+a]=g+f*Math.random(),s.array[n+a+1]=R;var A=utils.fibSpherePoint(t,d,200);for(a=0;a<9;a+=3)c.array[i+a]=A.x,c.array[i+a+1]=A.y,c.array[i+a+2]=A.z;for(y.x=p.x,y.y=-p.y,y.z=-p.z,y.normalize(),T=Math.PI*THREE.Math.randFloat(.5,2),a=0;a<12;a+=4)u.array[r+a]=y.x,u.array[r+a+1]=y.y,u.array[r+a+2]=y.z,u.array[r+a+3]=T}var b=new THREE.BAS.PhongAnimationMaterial({shading:THREE.FlatShading,side:THREE.DoubleSide,transparent:!0,uniforms:{uTime:{type:"f",value:0}},shaderFunctions:[THREE.BAS.ShaderChunk.cubic_bezier,THREE.BAS.ShaderChunk.ease_out_cubic,THREE.BAS.ShaderChunk.quaternion_rotation],shaderParameters:["uniform float uTime;","uniform vec3 uAxis;","uniform float uAngle;","attribute vec2 aAnimation;","attribute vec3 aEndPosition;","attribute vec4 aAxisAngle;"],shaderVertexInit:["float tDelay = aAnimation.x;","float tDuration = aAnimation.y;","float tTime = clamp(uTime - tDelay, 0.0, tDuration);","float tProgress = ease(tTime, 0.0, 1.0, tDuration);"],shaderTransformPosition:["transformed = mix(transformed, aEndPosition, tProgress);","float angle = aAxisAngle.w * tProgress;","vec4 tQuat = quatFromAxisAngle(aAxisAngle.xyz, angle);","transformed = rotateVector(tQuat, transformed);"]},{diffuse:4473924,specular:13421772,shininess:4});THREE.Mesh.call(this,o,b),this.frustumCulled=!1}function THREERoot(e){e=utils.extend({fov:60,zNear:10,zFar:1e5,createCameraControls:!0},e),this.renderer=new THREE.WebGLRenderer({antialias:e.antialias}),this.renderer.setPixelRatio(Math.min(2,window.devicePixelRatio||1)),document.getElementById("three-container").appendChild(this.renderer.domElement),this.camera=new THREE.PerspectiveCamera(e.fov,window.innerWidth/window.innerHeight,e.zNear,e.zfar),this.scene=new THREE.Scene,e.createCameraControls&&(this.controls=new THREE.OrbitControls(this.camera,this.renderer.domElement)),this.resize=this.resize.bind(this),this.tick=this.tick.bind(this),this.resize(),this.tick(),window.addEventListener("resize",this.resize,!1)}function createTweenScrubber(e,t){function n(){TweenMax.to(e,1,{timeScale:0})}function i(){TweenMax.to(e,1,{timeScale:1})}function r(n){var i=e.progress(),r=THREE.Math.clamp(i+n*t,0,1);e.progress(r)}t=t||.001;var a=0,o=!1;document.body.style.cursor="pointer",window.addEventListener("mousedown",function(e){o=!0,document.body.style.cursor="ew-resize",a=e.clientX,n()}),window.addEventListener("mouseup",function(e){o=!1,document.body.style.cursor="pointer",i()}),window.addEventListener("mousemove",function(e){if(!0===o){var t=e.clientX,n=t-a;a=t,r(n)}}),window.addEventListener("touchstart",function(e){a=e.touches[0].clientX,n(),e.preventDefault()}),window.addEventListener("touchend",function(e){i(),e.preventDefault()}),window.addEventListener("touchmove",function(e){var t=e.touches[0].clientX,n=t-a;a=t,r(n),e.preventDefault()})}window.onload=init,TextAnimation.prototype=Object.create(THREE.Mesh.prototype),TextAnimation.prototype.constructor=TextAnimation,Object.defineProperty(TextAnimation.prototype,"animationProgress",{get:function(){return this._animationProgress},set:function(e){this._animationProgress=e,this.material.uniforms.uTime.value=this.animationDuration*e}}),THREERoot.prototype={tick:function(){this.update(),this.render(),requestAnimationFrame(this.tick)},update:function(){this.controls&&this.controls.update()},render:function(){this.renderer.render(this.scene,this.camera)},resize:function(){this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(window.innerWidth,window.innerHeight)}};var utils={extend:function(e,t){for(var n in t)e[n]=t[n];return e},randSign:function(){return Math.random()>.5?1:-1},ease:function(e,t,n,i,r){return n+e.getRatio(t/r)*i},fibSpherePoint:function(){var e={x:0,y:0,z:0},t=Math.PI*(3-Math.sqrt(5));return function(n,i,r){var a,o,s=2/i;return e.y=n*s-1+.5*s,a=Math.sqrt(1-e.y*e.y),o=n*t,e.x=Math.cos(o)*a,e.z=Math.sin(o)*a,r=r||1,e.x*=r,e.y*=r,e.z*=r,e}}()};